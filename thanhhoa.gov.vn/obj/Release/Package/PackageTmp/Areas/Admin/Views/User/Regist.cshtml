@{
    ViewBag.Title = "Thêm mới người dùng";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
    var lstRole = (List<thanhhoa.gov.vn.Models.gov_role>)ViewData["lstRole"];
    var lstDepartment = (List<thanhhoa.gov.vn.Models.gov_department>)ViewData["lstDepartment"];
}
<script src="~/Areas/Admin/Resources/ckfinder/ckfinder.js"></script>
<section id="content">
    <section class="vbox">
        <section class="scrollable padder">
            <ul class="breadcrumb no-border no-radius b-b b-light pull-in">
                <li class="active">
                    <i class="fa fa-user"></i> Quản trị Người dùng
                </li>
                <li class="active">
                    <i class="fa fa-list-alt"></i> Danh sách người dùng
                </li>
                <li class="active">
                    <i class="fa fa-plus"></i> Thêm mới người dùng
                </li>
            </ul>
            <div class="row">
                <div class="col-sm-12">
                    <section class="panel panel-default">
                        <div class="panel-body">
                            <form class="bs-example form-horizontal" data-validate="parsley"
                                  enctype="multipart/form-data" action="SaveRegist" method="post">
                                <input type="hidden" name="checkusername" id="checkusername">
                                <h5 class="page-header m-t-xs" style="font-weight: 600;">
                                    <i class="fa fa-foursquare"></i> Thông tin tài khoản
                                </h5>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">
                                        Họ đệm <font color="red">*</font> :
                                    </span>
                                    <div class="col-lg-3">
                                        <input type="text" name="family_name"
                                               class="form-control input-sm"
                                               data-required="true"
                                               data-required-message="Trường Họ đêm không được bỏ trống"
                                               placeholder="Họ đệm">
                                    </div>
                                    <span class="col-lg-1 control-span">
                                        Tên <font color="red">*</font> :
                                    </span>
                                    <div class="col-lg-3">
                                        <input type="text" name="first_name"
                                               class="form-control input-sm"
                                               data-required="true"
                                               data-required-message="Trường Tên không được bỏ trống"
                                               placeholder="Tên">
                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">
                                        Tài khoản đăng
                                        nhập <font color="red">*</font> :
                                    </span>
                                    <div class="col-lg-3">
                                        <input type="text" id="txtAccount" name="username"
                                               class="form-control input-sm parsley-validated"
                                               data-equalto="#checkusername"
                                               data-equalto-message="Tài khoản đã tồn tại"
                                               data-required="true"
                                               data-required-message="Tài khoản không được bỏ trống"
                                               data-rangelength="[5,50]"
                                               data-rangelength-message="Tài khoản phải có độ dài từ 5 đến 50 kí tự"
                                               data-regexp="^[A-Za-z0-9_-]+$"
                                               data-regexp-message="Tài khoản không hợp lệ (Tài khoản chỉ được gồm các kí tự A - z, số, dấu gạch dưới và dấu gạch ngang.)"
                                               placeholder="Tài khoản đăng nhập">
                                    </div>
                                    <font class="text-info">
                                        <i>
                                            (Tài khoản đăng nhập chỉ
                                            được dùng chữ cái, số, dấu gạch dưới và dấu gạch ngang.)
                                        </i>
                                    </font>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">
                                        Mật khẩu <font color="red">*</font> :
                                    </span>
                                    <div class="col-lg-4">
                                        <input type="password" name="password" id="password"
                                               class="form-control input-sm"
                                               data-required="true"
                                               data-required-message="Mật khẩu không được bỏ trống"
                                               placeholder="Mật khẩu">
                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">
                                        Nhập lại mật
                                        khẩu <font color="red">*</font> :
                                    </span>
                                    <div class="col-lg-4">
                                        <input type="password" name="confirmpassword"
                                               class="form-control input-sm"
                                               data-required="true"
                                               data-required-message="Nhập lại mật khẩu không được bỏ trống"
                                               data-equalto="#password"
                                               data-equalto-message="Xác nhận mật khẩu không chính xác"
                                               placeholder="Nhập lại mật khẩu">
                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">Ngày sinh:</span>
                                    <div class="col-lg-4">
                                        <input type="text" name="birth_day"
                                               class="form-control input-sm" placeholder="Ngày sinh">
                                    </div>
                                    <span class="col-lg-1 control-span m-l">Giới tính:</span>
                                    <div class="col-lg-2">
                                        <select name="sex" class="form-control input-sm">
                                            <option value="true">Nam</option>
                                            <option value="false">Nữ</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">Địa chỉ:</span>
                                    <div class="col-lg-7">
                                        <input type="text" name="address"
                                               class="form-control input-sm" placeholder="Địa chỉ">
                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">Email:</span>
                                    <div class="col-lg-4">
                                        <input type="text" name="email"
                                               data-type="email"
                                               data-type-email-message="Phải nhập đúng định dạng email"
                                               class="form-control input-sm" placeholder="Email">
                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">
                                        Điện thoại cố
                                        định:
                                    </span>
                                    <div class="col-lg-4">
                                        <input type="text" name="phone"
                                               class="form-control input-sm"
                                               data-type="phone"
                                               data-type-phone-message="Phải nhập đúng định dạng điện thoại"
                                               placeholder="Điện thoại cố định">
                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">
                                        Điện thoại di
                                        động:
                                    </span>
                                    <div class="col-lg-4">
                                        <input type="text" name="mobile" class="form-control input-sm"
                                               data-type="phone"
                                               data-type-phone-message="Phải nhập đúng định dạng điện thoại"
                                               placeholder="Điện thoại di động">
                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">Chức vụ:</span>
                                    <div class="col-lg-4">
                                        <select name="role_id" id="roleId" style="width: 276px;">
                                            @{
                                                foreach (var item in lstRole)
                                                {
                                                    <option value="@item.id">@item.role_name</option>
                                                }
                                            }
                                        </select>

                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">Cơ quan:</span>
                                    <div class="col-lg-4">
                                        <select name="department_id" id="districtId" style="width: 276px;">
                                            @{
                                                foreach (var item in lstDepartment)
                                                {
                                                    <option value="@item.id">@item.name</option>
                                                }
                                            }
                                        </select>

                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l"></span>
                                    <div class="col-lg-4">
                                        <label><input type="checkbox" name="is_shared" value="TRUE" checked /> Cho phép hiển thị thông tin cá nhân trên danh bạ</label>
                                    </div>
                                </div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l">
                                        <input type="button" class="btnSearch" id="btnAvatar" value="Ảnh đại diện" />
                                    </span>
                                    <div class="col-lg-7">
                                        <input type="hidden" value="/Images/avatar_default.jpg" name="avatar" id="avatar">
                                        <img src="/Images/avatar_default.jpg" id="images" style="max-width: 200px;" />
                                    </div>
                                </div>
                                
                                <div class="line line-dashed line-lg pull-in"></div>
                                <div class="form-group m-b-xs">
                                    <span class="col-lg-2 control-span m-l"></span>
                                    <div class="col-lg-6">
                                        <button type="submit" class="btn btn-sm btn-primary"
                                                style="width: 90px;">
                                            Lưu
                                        </button>
                                        <a href="index" class="btn btn-sm btn-danger"
                                           style="width: 90px;">Hủy bỏ</a>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </section>
                </div>
            </div>
        </section>
        @Html.Partial("_PartialFooter")
    </section>
</section>
<script>
    $('#roleId').select2();
    $('#districtId').select2();

    $(function () {
        $('#txtAccount').on('input propertychange paste', function () {
            var t = setTimeout("change('" + $('#txtAccount').val() + "')", 100)
        });

        $('#btnAvatar').click(function () {
            var ckfinder = new CKFinder();
            ckfinder.selectActionFunction = function (fileUrl) {
                $('#avatar').val(fileUrl);
                $('#images').attr("src", fileUrl);
                urlImages = fileUrl;
            };
            ckfinder.popup();
        });
    });
    function change(username) {
        $.ajax({
            type: 'GET',
            url: "checkUsername",
            data: "username=" + username,
            success: function (data) {
                username = data;
                $('#checkusername').val(username);
            }
        });
    }
</script>
